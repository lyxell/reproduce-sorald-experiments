diff --git a/src/main/java/org/sqlite/SQLiteConnection.java b/src/main/java/org/sqlite/SQLiteConnection.java
index d5d78b8..8a852b4 100644
--- a/src/main/java/org/sqlite/SQLiteConnection.java
+++ b/src/main/java/org/sqlite/SQLiteConnection.java
@@ -289,18 +289,18 @@ public abstract class SQLiteConnection
         }
 
         byte[] buffer = new byte[8192]; // 8K buffer
-        FileOutputStream writer = new FileOutputStream(dbFile);
-        InputStream reader = resourceAddr.openStream();
-        try {
-            int bytesRead = 0;
-            while ((bytesRead = reader.read(buffer)) != -1) {
-                writer.write(buffer, 0, bytesRead);
+        try (FileOutputStream writer = new FileOutputStream(dbFile)) {
+            InputStream reader = resourceAddr.openStream();
+            try {
+                int bytesRead = 0;
+                while ((bytesRead = reader.read(buffer)) != -1) {
+                    writer.write(buffer, 0, bytesRead);
+                } 
+                return dbFile;
+            } finally {
+                writer.close();
+                reader.close();
             }
-            return dbFile;
-        }
-        finally {
-            writer.close();
-            reader.close();
         }
 
     }
diff --git a/src/test/java/org/sqlite/ConnectionTest.java b/src/test/java/org/sqlite/ConnectionTest.java
index 31599a5..eafb141 100644
--- a/src/test/java/org/sqlite/ConnectionTest.java
+++ b/src/test/java/org/sqlite/ConnectionTest.java
@@ -268,17 +268,16 @@ public class ConnectionTest
 
         File tmp = File.createTempFile(fileName, "", new File("target"));
         tmp.deleteOnExit();
-        FileOutputStream out = new FileOutputStream(tmp);
-
-        byte[] buf = new byte[8192];
-        for (int readBytes = 0; (readBytes = in.read(buf)) != -1;) {
-            out.write(buf, 0, readBytes);
+        try (FileOutputStream out = new FileOutputStream(tmp)) {
+            byte[] buf = new byte[8192];
+            for (int readBytes = 0; (readBytes = in.read(buf)) != -1;) {
+                out.write(buf, 0, readBytes);
+            }
+            out.flush();
+            out.close();
+            in.close();
+            return tmp;
         }
-        out.flush();
-        out.close();
-        in.close();
-
-        return tmp;
     }
 
     @Test
